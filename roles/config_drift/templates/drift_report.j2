Network Configuration Drift Report
Generated: {{ ansible_date_time.iso8601 }}
Timestamp: {{ timestamp }}

EXECUTIVE SUMMARY:
==================
Total devices checked: {{ total_devices }}
Devices with drift: {{ devices_with_drift }}
Devices remediated: {{ devices_remediated }}
Devices failed: {{ devices_failed }}
Devices backed up: {{ devices_backed_up }}
Devices without baseline: {{ devices_no_baseline }}

BREAKDOWN BY NETWORK OS:
========================
{% for os, devices in drift_by_os.items() %}
{{ os }}:
  - Total: {{ devices | length }}
  - With drift: {{ devices | selectattr('has_drift', 'equalto', true) | list | length }}
  - Remediated: {{ devices | selectattr('remediated', 'equalto', true) | list | length }}
  - No baseline: {{ devices | selectattr('baseline_found', 'equalto', false) | list | length }}

{% endfor %}

DETAILED DRIFT ANALYSIS:
========================
{% for result in drift_results %}
{% if result.has_drift %}
Device: {{ result.hostname }}
Network OS: {{ result.network_os }}
Status: {% if result.remediated %}REMEDIATED{% else %}DRIFT DETECTED{% endif %}
Baseline found: {{ 'Yes' if result.baseline_found else 'No' }}

Summary: {{ result.drift_details.summary }}

{% if result.drift_details.missing_configs %}
Missing baseline configurations:
{% for config in result.drift_details.missing_configs %}
  - {{ config }}
{% endfor %}

{% endif %}
{% if result.drift_details.different_configs %}
Configuration differences:
{% for diff in result.drift_details.different_configs %}
  Baseline: {{ diff.baseline }}
  Running:  {{ diff.running }}

{% endfor %}
{% endif %}
----------------------------------------

{% endif %}
{% endfor %}

{% if devices_no_baseline > 0 %}
DEVICES WITHOUT BASELINE:
=========================
{% for result in drift_results %}
{% if not result.baseline_found %}
- {{ result.hostname }} ({{ result.network_os }})
{% endif %}
{% endfor %}

{% endif %}
{% if failed_devices %}
FAILED DEVICES:
===============
{% for device in failed_devices %}
Device: {{ device.hostname }}
Error: {{ device.error }}

{% endfor %}
{% endif %}

{% if remediated_devices %}
SUCCESSFULLY REMEDIATED:
========================
{% for device in remediated_devices %}
- {{ device }}
{% endfor %}
{% endif %}

Report generated by Ansible Automation Platform
Configuration Drift Detection Service